{% trans_default_domain 'customer_portal' %}


<div class="alert bg-danger-soft text-dark border border-danger errors invoiced-klarna-errors hidden"></div>
<div class="col-lg-6">

  <!-- Billing Address -->
  <div class="form-section">
    <div class="line">
      <label class="form-label">{{ 'labels.email_address'|trans }}</label>
      <div>
        <input type="text" name="email" value="{{ address.email }}" class="form-control" id="klarna-email" required />
      </div>
    </div>

    <div>&nbsp;</div>

    {% if allowedTypes.klarna is defined %}
      <div class="form-check form-check-inline {% if allowedTypes|length == 1 %}hidden{% endif %}">
        <input type="radio" class="form-check-input account_holder_type" name="klarna_type" value="klarna" {% if allowedTypes|length == 1 %}checked="checked"{% endif %} id="type_klarna" required />
        <label class="form-check-label noselect" for="type_klarna">
          {{ 'labels.klarna'|trans }}
        </label>
      </div>
    {% endif %}

    {% if allowedTypes.klarna_account is defined %}
      <div class="form-check form-check-inline {% if allowedTypes|length == 1 %}hidden{% endif %}">
        <input type="radio" class="form-check-input account_holder_type" name="klarna_type" value="klarna_account" {% if allowedTypes|length == 1 %}checked="checked"{% endif %} id="type_klarna_account" required />
        <label class="form-check-label noselect" for="type_klarna_account">
          {{ 'labels.klarna_account'|trans }}
        </label>
      </div>
    {% endif %}

    {% if allowedTypes.klarna_paynow is defined %}
      <div class="form-check form-check-inline {% if allowedTypes|length == 1 %}hidden{% endif %}">
        <input type="radio" class="form-check-input account_holder_type" name="klarna_type" value="klarna_paynow" {% if allowedTypes|length == 1 %}checked="checked"{% endif %} id="type_klarna_paynow" />
        <label class="form-check-label noselect" for="type_klarna_paynow">
          {{ 'labels.klarna_paynow'|trans }}
        </label>
      </div>
    {% endif %}

    {% if allowedTypes|length > 1 %}<div>&nbsp;</div>{% endif %}

    <label class="section-label">
      {{ 'labels.please_billing_address'|trans }}
    </label>

    <div class="billing-address address billing">
      <div class="line">
        <div class="input-card-holder-name input no-icon">
          <input name="shopperName" type="text" class="form-control cc-name required" placeholder="{{ 'labels.cardholder_name'|trans }}" value="{{ address.name }}" required />
        </div>
      </div>

      <div class="line">
        <div class="input-address-line1 input no-icon">
          <input name="street" type="text" class="form-control cc-address1 billing-address1 required" placeholder="{{ 'labels.address_line1'|trans }}" value="{{ address.address1 }}" required />
        </div>
      </div>

      <div class="line">
        <div class="input-address-line2 input no-icon">
          <input name="houseNumberOrName" type="text" class="form-control cc-address1 billing-address1 required" placeholder="{{ 'labels.address_line2'|trans }}" value="{{ address.address2 }}" />
        </div>
      </div>

      <div class="line">
        <div class="input-split split-4060">
          <div class="input-address-city input no-icon">
            <input name="city" type="text" class="form-control cc-city billing-city" placeholder="{{ 'labels.address_city'|trans }}" value="{{ address.city }}" required />
          </div>
          <div class="input-address-state input no-icon">
            <div class="state-select hidden">
              <select class="form-select"></select>
            </div>
            <input name="stateOrProvince" type="text" class="form-control state-text cc-state billing-state required" placeholder="{{ 'labels.address_state'|trans }}" value="{{ address.state }}" required />
          </div>
        </div>
      </div>

      <div class="line">
        <div class="input-split split-4060">
          <div class="input-address-zip input no-icon">
            <input name="postalCode" type="text" class="form-control cc-postal-code billing-postal-code" placeholder="{{ 'labels.address_postal_code'|trans }}" value="{{ address.postal_code }}" required />
          </div>

          <div class="input-address-country input no-icon">
            <select name="country"  class="form-select country-selector billing cc-country billing-country" data-section="billing" required>
              {% for country in countries %}
                <option value="{{ country.code }}"{% if country.code == address.country %} selected="selected"{% endif %}>{{ country.country }}</option>
              {% endfor %}
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="mb-3" id="klarna-card-container"></div>

<script id="klarna-card-data" type="text/json">
  {{ adyenData|json_encode|raw }}
</script>

<script src="{{ scriptUrl }}" crossorigin="anonymous"></script>
<link rel="stylesheet" href="{{ stylesheetUrl }}" crossorigin="anonymous" />
<script type="text/javascript" src="{{ asset('/js/views/paymentForms/klarna.js') }}?t={{ 'now'|date('U') }}"></script>