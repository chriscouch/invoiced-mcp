<div class="header">
    {% if company.logo %}
        <img src="{{ company.logo }}" />
    {% else %}
        {{ company.name }}
    {% endif %}
    <div class="company-address">
        {% if company.logo %}
            <div class="name"><span style="font-weight: bold;">{{ company.name }}</span></div>
        {% endif %}
        <div class="address">{{ company.address|nl2br }}</div>
        {% if company.email %}<div class="email">{{ company.email }}</div>{% endif %}
        {% if company.phone %}<div class="phone">{{ company.phone }}</div>{% endif %}
        {% if company.website %}<div class="website">{{ company.website }}</div>{% endif %}
    </div>
    <div class="subtitle-line">
        <span class="bolder">{{ customer.name }}</span><br>
        <div>
            {%  if statement.type == 'balance_forward' %}
                {% if statement.start %}
                    {{ trans('titles.account_summary_since', {'%start_date%': statement.start, '%end_date%': statement.end}) }}
                {% else %}
                    {{ trans('titles.account_summary', {'%date%': statement.end}) }}
                {% endif %}
            {%  elseif statement.type == 'open_item' %}
                {{ trans('titles.account_detail') }}
            {%  endif %}
        </div>
    </div>
</div>

<div class="context-holder">
    <div class="context-item">
        <div class="bolder">{% if theme.use_translations %}{{ trans('labels.bill_to') }}{% else %}{{ theme.to_title }}{% endif %}</div>
        {% if customer.attention_to %}<div class="attention_to">{{ trans('labels.attention_to') }}: {{ customer.attention_to }}</div>{% endif %}
        <div class="name">{{ customer.name }}</div>
        <div class="address">{{ customer.address|nl2br }}</div>
    </div>
</div>

{%  if statement.type == 'balance_forward' %}
    <div class="items-holder">
        <table>
            <thead class="bolder">
                <tr>
                    <th colspan="{% if statement.subCustomers %}6{% else %}5{% endif %}" class="highlight-color-border">
                        {{ trans('titles.account_detail') }}
                    </th>
                </tr>
                <tr>
                    <th class="highlight-color-border narrow">{{ trans('columns.date') }}</th>
                    {% if statement.subCustomers %}<th class="highlight-color-border">{{ trans('columns.customer') }}{% endif %}</th>
                    <th class="highlight-color-border">{{ trans('columns.description') }}</th>
                    <th class="highlight-color-border narrow money-column">{{ trans('columns.invoiced') }}</th>
                    <th class="highlight-color-border narrow money-column">{{ trans('columns.paid') }}</th>
                    <th class="highlight-color-border total-narrow money-column">{{ trans('columns.balance') }}</th>
                </tr>
            </thead>
            <tbody>
                {% for line in statement.accountDetail %}
                    <tr class="item">
                        <td>{{ line.date }}</td>
                        {% if statement.subCustomers %}
                            <td>{{ line.customer.name }}</td>
                        {% endif %}
                        <td>{{ line.number }}</td>
                        <td class="amount">
                            {% if line.invoiced %}
                                {{ line.invoiced|money }}
                            {% endif %}
                        </td>
                        <td class="amount">
                            {% if line.paid %}
                                {{ line.paid|money }}
                            {% endif %}
                        </td>
                        <td class="amount">{{ line.balance|money }}</td>
                    </tr>
                {%  endfor %}
                <tr>
                    <td height="2" colspan="{% if statement.subCustomers %}6{% else %}5{% endif %}"> </td>
                </tr>
                {% if statement.previousBalance %}
                    <tr class="summary-item">
                        <td colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.previous_balance') }}</td>
                        <td class="value">{{ statement.previousBalance|money }}</td>
                    </tr>
                {% endif %}
                <tr class="summary-item">
                    <td colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.total_invoiced') }}</td>
                    <td class="value">{{ statement.totalInvoiced|money }}</td>
                </tr>
                <tr class="summary-item">
                    <td colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.total_paid') }}</td>
                    <td class="value">{{ statement.totalPaid|money }}</td>
                </tr>
                {% if statement.totalUnapplied %}
                    <tr class="summary-item">
                        <td colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.unapplied_payments') }}</td>
                        <td class="value">{{ statement.totalUnapplied|money }}</td>
                    </tr>
                {% endif %}
                <tr class="summary-item">
                    <td  class="bolder top-border" colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.account_balance') }}</td>
                    <td class="value bolder top-border">{{ statement.balance|money }}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Credit Balance History -->
    {% if statement.hasCredits %}
        <div class="items-holder">
            <table class="items">
                <thead>
                    <tr>
                        <th colspan="{% if statement.subCustomers %}6{% else %}5{% endif %}" class="highlight-color-border">
                            {{ trans('titles.credit_balance_history') }}
                        </th>
                    </tr>
                    <tr>
                        <th class="highlight-color-border narrow">{{ trans('columns.date') }}</th>
                        {% if statement.subCustomers %}<th class="highlight-color-border">{{ trans('columns.customer') }}{% endif %}</th>
                        <th class="highlight-color-border">{{ trans('columns.description') }}</th>
                        <th class="highlight-color-border narrow money-column">{{ trans('columns.issued') }}</th>
                        <th class="highlight-color-border narrow money-column">{{ trans('columns.spent') }}</th>
                        <th class="highlight-color-border narrow money-column">{{ trans('columns.balance') }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for line in statement.creditDetail %}
                        <tr class="item">
                            <td>{{ line.date }}</td>
                            {% if statement.subCustomers %}
                                <td>{{ line.customer.name }}</td>
                            {% endif %}
                            <td>{{ line.description }}</td>
                            <td>{{ line.issued|money }}</td>
                            <td>{{ line.charged|money }}</td>
                            <td>{{ line.creditBalance|money }}</td>
                        </tr>
                    {% endfor %}
                    <tr>
                        <td height="2" colspan="{% if statement.subCustomers %}6{% else %}5{% endif %}"> </td>
                    </tr>
                    {% if statement.previousCreditBalance %}
                        <tr class="summary-item">
                            <td class="field" colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.previous_balance') }}</td>
                            <td class="value">{{ statement.previousCreditBalance|money }}</td>
                        </tr>
                    {% endif %}
                    <tr class="summary-item">
                        <td class="field" colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.total_issued') }}</td>
                        <td class="value">{{ statement.totalCreditsIssued|money }}</td>
                    </tr>
                    <tr class="summary-item">
                        <td colspan="{% if statement.subCustomers %}4{% else %}3{% endif %}"></td>
                        <td class="field">{{ trans('labels.total_spent') }}</td>
                        <td class="value">{{ statement.totalCreditsSpent|money }}</td>
                    </tr>
                    <tr class="summary-item">
                        <td class="bolder top-border" colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">{{ trans('labels.credit_balance') }}</td>
                        <td class="value bolder top-border">{{ statement.creditBalance|money }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    {% endif %}

    <div class="items-holder">
        <table class="items">
            {% if statement.previousBalance %}
                <tr class="summary-item">
                    <td></td>
                    <td class="field">{{ trans('labels.previous_balance') }}</td>
                    <td class="value">{{ statement.previousBalance|money }}</td></tr>
            {% endif %}
            <tr class="summary-item">
                <td></td>
                <td class="field">{{ trans('labels.invoiced') }}</td>
                <td class="value">{{ statement.totalInvoiced|money }}</td></tr>
            <tr class="summary-item">
                <td></td>
                <td class="field">{{ trans('labels.statement_payments') }}</td>
                <td class="value"><span class="negative-sign">&#8211;</span>{{ statement.totalPaid|money }}</td>
            </tr>
            {% if statement.totalUnapplied %}
                <tr class="summary-item">
                    <td></td>
                    <td class="field">{{ trans('labels.unapplied_payments') }}</td>
                    <td class="value">{{ statement.totalUnapplied|money }}</td>
                </tr>
            {% endif %}
            <tr class="summary-item">
                <td></td>
                <td class="field">{{ trans('labels.account_balance') }}</td>
                <td class="value">{{ statement.balance|money }}</td>
            </tr>
            {% if statement.hasCredits %}
                <tr class="summary-item">
                    <td></td>
                    <td class="field">{{ trans('labels.credit_balance') }}</td>
                    <td class="value">{{ statement.creditBalance|money }}</td>
                </tr>
            {% endif %}
        </table>
    </div>
{% elseif statement.type == 'open_item' %}
    <div class="items-holder">
        <table>
            <thead class="bolder">
                <tr>
                    <th colspan="{% if statement.subCustomers %}6{% else %}5{% endif %}">
                        {% if statement.pastDueOnly %}
                            {{ trans('titles.past_due_items', {'%date%': statement.end}) }}
                        {% else %}
                            {{ trans('titles.open_items', {'%date%': statement.end}) }}
                        {% endif %}
                    </th>
                </tr>
                <tr>
                    <th class="highlight-color-border narrow">{{ trans('columns.date') }}</th>
                    {% if statement.subCustomers %}<th class="highlight-color-border">{{ trans('columns.customer') }}{% endif %}</th>
                    <th class="highlight-color-border">{{ trans('columns.description') }}</th>
                    <th class="highlight-color-border narrow money-column">{{ trans('columns.total') }}</th>
                    <th class="highlight-color-border narrow money-column">{{ trans('columns.due_date') }}</th>
                    <th class="highlight-color-border total-narrow money-column">{{ trans('columns.balance') }}</th>
                </tr>
            </thead>
            <tbody>
                {% for line in statement.accountDetail %}
                    <tr class="item">
                        <td>{{ line.date }}</td>
                        {% if statement.subCustomers %}
                            <td>{{ line.customer.name }}</td>
                        {% endif %}
                        <td>{{ line.number }}</td>
                        <td class="money-column">{{ line.total|money }}</td>
                        <td class="money-column">{{ line.dueDate }}</td>
                        <td class="money-column">{{ line.balance|money }}</td>
                    </tr>
                {% endfor %}
                <tr>
                    <td height="2" colspan="{% if statement.subCustomers %}6{% else %}5{% endif %}"> </td>
                </tr>
                <tr class="summary-item">
                    <td colspan="{% if statement.subCustomers %}5{% else %}4{% endif %}">
                        {% if statement.pastDueOnly %}
                            {{ trans('labels.past_due_balance') }}
                        {% else %}
                            {{ trans('labels.total_balance') }}
                        {% endif %}
                    </td>
                    <td class="value">{{ statement.balance|money }}</td>
                </tr>
            </tbody>
        </table>
    </div>
{% endif %}
