{% set canonicalUrl=url('signup_form') %}
{% set title='Sign Up' %}
{% set metaDescription='Create an Invoiced account to send invoices, approve bills, pay vendors, and build your business network.' %}
{% extends "auth/parent.twig" %}
{#Prevents this page from being indexed or followed by search engines#}
{% set robotsDefault = 'noindex,nofollow' %}

{% block bodyClass %}d-flex align-items-center bg-auth border-top border-top-3 border-primary{% endblock %}

{% block header %}
    {# Google Search Console verification â€” allows us to request manual page deindexing insted of waiting of google to do it #}
    <meta name="google-site-verification" content="9jcjUvouu0U39YDEZHuJ4Jvl4ba3ujWaG0RZkk3ec44" />

    <script type="text/javascript" src="{{ asset("/js/auth.js") }}"></script>
    <script async src="https://www.google.com/recaptcha/api.js"></script>
    <script>
        var init = new Date();
        $(function() {
            var timezone = jstz.determine().name();
            $('#timezone').val(timezone);
        });

        function onSubmit(token) {
            var now = new Date();
            document.getElementById("form_delta").value = now - init;
            document.getElementById("signupForm").submit();
        }
    </script>
{% endblock %}

{% block main %}

    {% if app.environment != 'production' %}
        <div class="test-mode"></div>
    {% endif %}

    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-12 col-md-8 col-lg-6 col-xl-5 px-lg-6 my-5 align-self-center">
                <div class="text-center">
                    <img src="{{ asset('/img/logo.png') }}" alt="Invoiced" height="45" class="mw-100"/>
                </div>
                <div class="card p-5 mt-5 mx-auto" style="max-width: 500px;">
                    <h1 class="display-4 text-center mb-3">
                        {% if freeTrial %}
                            Try out Invoiced
                        {% else %}
                            Create an account
                        {% endif %}
                    </h1>

                    <p class="text-muted text-center mb-5">
                        {% if freeTrial %}
                            Sign up for a 30-day free trial.
                        {% else %}
                            Start sending and receiving invoices in minutes.
                        {% endif %}
                    </p>

                    {% for error in app.flashes('signup_error') %}
                        <div class="text-danger mb-3" role="alert">{{ error|nl2br }}</div>
                    {% endfor %}

                    <form method="post" action="{{ path('signup', {invitation: app.request.query.get('invitation')}) }}" id="signupForm">
                        <input type="hidden" name="_csrf_token" value="{{ csrf_token('signup') }}" />
                        <input type="hidden" name="r" value="{{ reseller }}" />
                        <input type="hidden" name="i" value="{{ invoices }}" />
                        <input type="hidden" name="tz" id="timezone" />
                        <input type="hidden" name="delta" id="form_delta" />

                        <div class="mb-3">
                            <div class="row">
                                <div class="col-sm-6">
                                    <label for="registration_form_first_name" class="form-label required">
                                        First Name
                                    </label>
                                    <input type="text" id="registration_form_first_name" name="first_name" value="{{ firstName }}" required class="form-control" />
                                </div>
                                <div class="col-sm-6">
                                    <label for="registration_form_last_name" class="form-label required">
                                        Last Name
                                    </label>
                                    <input type="text" id="registration_form_last_name" name="last_name" value="{{ lastName }}" required class="form-control" />
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="registration_form_email" class="form-label required">
                                Email
                            </label>
                            <input type="text" id="registration_form_email" name="email" value="{{ email }}" required class="form-control" />
                        </div>

                        <div class="mb-3">
                            <label for="registration_form_password" class="form-label required">
                                Password
                            </label>
                            <input type="password" id="registration_form_password" name="password" required class="form-control" />
                        </div>

                        <div class="form-group">
                            <label for="registration_form_country" class="control-label required">Country</label>
                            <div>
                                <select class="form-select" name="country" id="registration_form_country" required>
                                    <option value="">-- Select One</option>
                                    {% for country in countries %}
                                        <option value="{{ country.code }}" {% if selectedCountry == country.code %}selected="selected"{% endif %}>{{ country.country }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="form-group mt-5">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="agree_tos" value="1" id="tosCheck" required="required" />
                                <label class="form-check-label" for="tosCheck">
                                    I agree to the <a href="https://www.invoiced.com/terms">Terms of Service</a> and <a href="https://www.invoiced.com/privacy">Privacy Policy</a>.
                                </label>
                            </div>
                        </div>

                        <button type="button" data-sitekey="6LfBzJkiAAAAAP0HW4F4s9PLh8EiLGtbEeei5KQM" data-callback="onSubmit" data-action="submit" class="g-recaptcha btn btn-lg w-100 btn-primary mb-3">
                            Sign Up
                        </button>
                    </form>

                    <div class="text-center border-top mt-4 pt-4">
                        <small class="text-center fs-3">
                            Already have an account? <a href="{{ path('login_redirect', app.request.query.all) }}">Log in</a>.
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-7 col-lg-6 col-xl-7 align-self-center">
                <div style="max-width: 750px;">
                    <div class="mt-4 mb-3 fs-1 lead">
                        {% if invitation %}
                            You have been invited by <strong>{{ invitation.from_company.name }}</strong> to join the world's fastest growing invoicing network.
                        {% else %}
                            Join the world's fastest growing invoicing network.
                        {% endif %}
                    </div>

                    <div class="fs-3 lead mt-4">Invoiced is the simple, secure way to send, receive, approve, and pay invoices.</div>

                    <div class="mt-5">
                        <img src="{{ asset('/img/signup/howitworks.png') }}" alt="How It Works" class="img-fluid" />
                    </div>

                    <div class="mt-5">
                        <small class="d-block mb-3 text-muted">&copy; {{ 'now'|date('Y') }} Invoiced, Inc.</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
