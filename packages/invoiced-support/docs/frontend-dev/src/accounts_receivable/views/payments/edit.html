<form name="paymentForm" ng-submit="save(payment)" class="below0">
    <div class="modal-header">
        <a role="button" class="close" ng-click="close()" aria-hidden="true">&times;</a>
        <h4 class="modal-title">
            {{'payments.edit.title'|translate}}
        </h4>
    </div>
    <div class="modal-body form-horizontal">
        <p class="required-indicator">
            <span class="required"></span> {{'general.required'|translate}}
        </p>
        <p class="alert alert-danger" ng-show="error">
            {{error.message}}
        </p>

        <!-- Payment Date -->
        <div class="form-group">
            <label class="control-label col-sm-3">{{'general.date'|translate}} <span class="required"></span></label>
            <div class="col-sm-4">
                <div class="input-group">
                    <input type="text" class="form-control" ng-model="payment.date" ui-date="dateOptions" is-open="dpOpened" readonly="readonly" required />
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-primary" ng-click="openDatepicker($event, 'dpOpened')">
                            <span class="fas fa-calendar-alt"></span>
                        </button>
                    </span>
                </div>
            </div>
        </div>

        <!-- Currency -->
        <div class="form-group" ng-if="('multi_currency'|hasFeature)">
            <label class="control-label col-sm-3">{{'payments.edit.labels.currency'|translate}} <span class="required"></span></label>
            <div class="col-sm-3">
                <currency-selector ng-model="payment.currency" required></currency-selector>
            </div>
        </div>

        <!-- Payment Amount -->
        <div class="form-group">
            <label class="control-label col-sm-3">{{'general.amount'|translate}} <span class="required"></span></label>
            <div class="col-sm-4">
                <input class="form-control" type="text" currency-input ng-model="payment.amount" currency="payment.currency" required="required" />
            </div>
        </div>

        <!-- Payment Method -->
        <div class="form-group">
            <label class="control-label col-sm-3">{{'payments.labels.method'|translate}}</label>
            <div class="col-sm-4">
                <payment-method-selector ng-model="payment.method"></payment-method-selector>
            </div>
        </div>

        <!-- Check # -->
        <div class="form-group" ng-show="payment.method=='check'">
            <label class="control-label col-sm-3">{{'payments.labels.check_no'|translate}}</label>
            <div class="col-sm-5">
                <input class="form-control" type="text" ng-model="payment.reference" />
            </div>
        </div>

        <!-- Transaction ID -->
        <div class="form-group" ng-show="payment.method=='credit_card'||payment.method=='ach'">
            <label class="control-label col-sm-3">{{'transactions.labels.transaction_id'|translate}}</label>
            <div class="col-sm-5">
                <input class="form-control" type="text" ng-model="payment.reference" />
            </div>
        </div>

        <!-- Reference -->
        <div class="form-group" ng-show="payment.method!=='check'&&payment.method!=='credit_card'&&payment.method!=='ach'">
            <label class="control-label col-sm-3">{{'transactions.labels.reference'|translate}}</label>
            <div class="col-sm-5">
                <input class="form-control" type="text" ng-model="payment.reference" />
            </div>
        </div>

        <!-- Card Warning -->
        <p class="alert alert-warning" ng-show="payment.method=='credit_card'">
            <span class="fas fa-info-circle"></span>
            {{'transactions.warnings.credit_card'|translate}}
        </p>

        <!-- ACH Warning -->
        <p class="alert alert-warning" ng-show="payment.method=='ach'">
            <span class="fas fa-info-circle"></span>
            {{'transactions.warnings.ach'|translate}}
        </p>

        <!-- Customer -->
        <div class="form-group">
            <label class="control-label col-sm-3">{{'payments.labels.customer'|translate}}</label>
            <div class="col-sm-7">
                <select-customer ng-model="payment.customer"></select-customer>
                <a href="" ng-show="payment.customer" ng-click="clearCustomer()">
                    {{'general.clear'|translate}}
                </a>
            </div>
        </div>

        <!-- Notes -->
        <div class="form-group">
            <label class="control-label col-sm-3">{{'payments.labels.notes'|translate}}</label>
            <div class="col-sm-7">
                <textarea class="notes form-control" tabindex="2003" ng-model="payment.notes" expanding-textarea></textarea>
            </div>
        </div>

        <!-- Custom Fields -->
        <div class="form-group invoice-editor"  ng-repeat="field in customFields">
            <label class="control-label col-sm-3">{{field.name}}</label>
            <div class="col-sm-7">
                <custom-field-input field="field" metadata="payment.metadata" set-defaults="true"></custom-field-input>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button type="submit" class="btn btn-primary Button" ng-disabled="paymentForm.$invalid||loading||saving" v-busy="saving" v-busy-label="{{'general.saving'|translate}}" v-busy-text="{{'general.save'|translate}}" v-pressable>
            <span translate>general.save</span>
        </button>
    </div>
</form>
