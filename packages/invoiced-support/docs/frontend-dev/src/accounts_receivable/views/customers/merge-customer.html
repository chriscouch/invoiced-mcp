<div class="modal-header">
	<a role="button" class="close" ng-click="close()" aria-hidden="true">&times;</a>
	<h4 class="modal-title">Merge Customer</h4>
</div>
<div class="modal-body" ng-hide="isPreviewing">
	<p class="lead">Which customer would you like to merge into this customer?</p>
	<p>
		 The customer you select will have all of their associated transactions and payment information moved into this customer. The selected customer will be deleted. <strong>Merging a customer is permanent and cannot be undone.</strong>
	</p>

	<div class="row">
		<div class="col-sm-6">
			<div class="form-group">
				<label class="control-label">Merge</label>
				<div>
					<select-customer ng-model="customer2" excluded="excludeCustomerIds"></select-customer>
				</div>
			</div>
		</div>
		<div class="col-sm-1 hidden-xs">
			<div class="merge-into-arrow">
				<span class="fas fa-arrow-alt-right"></span>
			</div>
		</div>
		<div class="col-sm-5">
			<div class="form-group">
				<label class="control-label">Into</label>
				<div>
					<strong>{{customer.name}}</strong><br/>
					{{customer.number}}
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal-footer" ng-hide="isPreviewing">
	<button type="button" class="btn btn-primary" ng-click="preview(customer, customer2)" ng-disabled="!customer2">
		Preview
	</button>
</div>

<!-- Preview -->
<div class="modal-body" ng-if="isPreviewing">
	<p>
		Please confirm that you would like to merge the customer on the left into the customer on the right. <strong>Merging a customer is permanent and cannot be undone.</strong>
	</p>
	<hr/>

	<div class="alert alert-danger" ng-show="error">{{error}}</div>

	<div class="row">
		<div class="col-sm-5">
			<div class="form-group">
				<label class="control-label">Merging Customer</label>
				<div>
					<strong>{{previewCustomer2.name}}</strong>
				</div>
				<div>
					{{previewCustomer2.number}}
				</div>
				<div ng-show="previewCustomer2.address1">
					Address:<br/>
					<span ng-bind-html="previewCustomer2|address:false:true:true"></span>
				</div>
				<div ng-show="previewCustomer2.email">
					Email: {{previewCustomer2.email}}
				</div>
				<div ng-show="previewCustomer2.phone">
					Phone: {{previewCustomer2.phone|formatPhoneNumber}}
				</div>
			</div>
			<p class="text-danger">
				<span class="fas fa-exclamation-triangle"></span>
				This customer will be deleted.
			</p>
		</div>
		<div class="col-sm-1 hidden-xs">
			<div class="merge-into-arrow">
				<span class="fas fa-arrow-alt-right"></span>
			</div>
		</div>
		<div class="col-sm-5">
			<div class="form-group">
				<label class="control-label">Resulting Customer</label>
				<div>
					<strong>{{previewCustomer1.name}}</strong>
				</div>
				<div>
					{{previewCustomer1.number}}
				</div>
				<div ng-show="previewCustomer1.address1">
					Address:<br/>
					<span ng-bind-html="previewCustomer1|address:false:true:true"></span>
				</div>
				<div ng-show="previewCustomer1.email">
					Email: {{previewCustomer1.email}}
				</div>
				<div ng-show="previewCustomer1.phone">
					Phone: {{previewCustomer1.phone|formatPhoneNumber}}
				</div>
			</div>
			<p class="text-success">
				All data will be merged into this customer.
			</p>
		</div>
	</div>
</div>
<div class="modal-footer" ng-show="isPreviewing">
	<div class="left">
		<a href="" ng-click="cancelPreview()">
			&larr;
			Back
		</a>
	</div>
	<button type="button" ng-click="save(customer, customer2)" class="btn btn-primary Button" ng-disabled="saving" v-busy="saving" v-busy-label="Merging" v-pressable>
		Merge
	</button>
</div>